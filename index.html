<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />

  <!-- ðŸ”¥ CLAVE PARA MÃ“VIL -->
 

  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <title>Airbnb AR Assistant</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: sans-serif;
    }

    a-scene {
      position: fixed;
      inset: 0;
      z-index: 1;
    }

    /* ðŸ”¥ UI ENCIMA DEL AR */
    #ui {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 9999;
      display: flex;
      gap: 8px;
      background: rgba(0,0,0,0.7);
      padding: 10px;
      border-radius: 12px;
    }

    #ui input {
      width: 220px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
    }

    #ui button {
      padding: 10px 14px;
      border-radius: 8px;
      border: none;
      background: #00c853;
      color: #fff;
      font-weight: bold;
      font-size: 16px;
    }
  </style>
</head>

<body>

  <!-- ESCENA AR -->
<a-scene
  vr-mode-ui="enabled: false"
  embedded
  arjs="sourceType: webcam; facingMode: environment; debugUIEnabled: false;"
>

  <a-camera position="0 0 0" look-controls="enabled: false">

    <!-- CONTENEDOR FLOTANTE (ANIMADO) -->
    <a-entity
      id="arFloat"
      position="0 0 -2"
      animation="property: position;
                 dir: alternate;
                 dur: 3000;
                 easing: easeInOutSine;
                 loop: true;
                 to: 0 0.15 -2">

      <!-- PANEL AR (ÃšNICO) -->
      <a-entity
        id="arPanel"
        scale="0 0 0">

        <a-plane
          width="1.8"
          height="1"
          color="#111"
          opacity="0.75">
        </a-plane>

        <a-text
          id="arText"
          value=""
          width="1.6"
          color="#FFFFFF"
          align="center"
          position="0 0 0.01"
          wrap-count="40">
        </a-text>

      </a-entity>

    </a-entity>

  </a-camera>

</a-scene>




  <!-- ðŸ”¥ UI HTML -->
  <div id="ui">
    <input
      id="questionInput"
      placeholder="Ej: Â¿A quÃ© hora es el check-in?"
    />
    <button onclick="askAI()">Enviar</button>
  </div>

  <script>
  let hideTimer = null;

  function showARAnswer(text) {
    const panel = document.getElementById("arPanel");
    const arText = document.getElementById("arText");

    arText.setAttribute("value", text);

    // Mostrar panel
    panel.setAttribute("scale", "1 1 1");

    // Cancelar ocultado previo
    if (hideTimer) {
      clearTimeout(hideTimer);
    }

    // Auto-ocultar despuÃ©s de 8s
    hideTimer = setTimeout(() => {
      panel.setAttribute("scale", "0 0 0");
    }, 8000);
  }

  async function askAI() {
    const input = document.getElementById("questionInput");
    if (!input.value) return;

    const res = await fetch(
      "https://gayla-subcalibre-destiny.ngrok-free.dev/ask",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          property_id: "demo_property",
          question: input.value
        })
      }
    );

    const data = await res.json();
    showARAnswer(data.answer);
    input.value = "";
  }
</script>


</body>
</html>
